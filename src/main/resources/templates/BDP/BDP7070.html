<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <div th:replace="~{BDP/include/include :: head}"></div>
    <title>TAG 마스터 이벤트처리</title>
    <script type="text/javascript">
        //*********************************************************************************************
        // ********** Declare public variable
        //*********************************************************************************************
        var gridTagMstEvent, gridTagMstEventId;

        //*********************************************************************************************
        // ********** Function Ready Section
        //*********************************************************************************************
        $(document).ready(function () {
            // 세션 데이터 초기화
            initializeSessionData();
            
            f_initSreen();
            f_initSearchForm();
            f_initContents();
            f_lastProc();
        }); // end of ready

        //*********************************************************************************************
        // ********** Initialize Session Data Section
        //*********************************************************************************************
        function initializeSessionData() {
            // sessionStorage에 목 데이터 직접 저장
            sessionStorage.setItem('GW_USER_ID', '99991201');
            sessionStorage.setItem('GW_PGM_ID', 'SI0003');
            sessionStorage.setItem('GW_LANG_CD', 'KO');
            sessionStorage.setItem('GW_LINE_CD', '');
            sessionStorage.setItem('GW_PLANT_CD', '1000');
            sessionStorage.setItem('GW_CLIENT_IP', '10.2.110.216');
            sessionStorage.setItem('GW_EMP_NO', '99991201');
            sessionStorage.setItem('GW_DEPT_CD', '');
            sessionStorage.setItem('GW_ROLE_CD', 'MES_INQ_ROLE,MB_TEMP,ITSM');
            sessionStorage.setItem('GW_USER_NM', '김성준');
            sessionStorage.setItem('GW_DEPT_NM', '');
            sessionStorage.setItem('GW_TITLE', '');
            sessionStorage.setItem('GW_WELCOME_PGM_ID', 'SI0003');
            sessionStorage.setItem('GW_SERVER_INFO', '개발');
            sessionStorage.setItem('GW_SSO_YN', 'N');
            sessionStorage.setItem('GW_OUTSIDE_ACCESS_YN', 'N');
            sessionStorage.setItem('GW_PASSWD_EXPIRE_DT', '20251215');
            sessionStorage.setItem('GW_OPER_DT', 'jsonData:"1899-11-29T15:32:08.000Z"');
            
            console.log('Session data initialized with mock data');
            console.log('GW_USER_ID:', sessionStorage.getItem('GW_USER_ID'));
            console.log('GW_PGM_ID:', sessionStorage.getItem('GW_PGM_ID'));
        } // end of initializeSessionData

        //*********************************************************************************************
        // ********** initialize screen Section
        //*********************************************************************************************
        function f_initSreen() {
            serviceName = "SMZ7070-service";
        } // end of f_initSreen

        //*********************************************************************************************
        // ********** Initialize Search Condition Section
        //*********************************************************************************************
        function f_initSearchForm() {
            fc_makeSearch( '', 'TAG_MST_EVENT', '' );
        } // end of f_initSearchForm

        //*********************************************************************************************
        // ********** Initialize DATA Section
        //*********************************************************************************************
        function f_initContents () {
            gridTagMstEvent   = fc_makeGrid( 'divGridTagMstEvent', 'insert', 'TAG_MST_EVENT', '', false );
            gridTagMstEventId = gridTagMstEvent.getGridId();

            $("#"+ gridTagMstEventId).on("cellclick", function (event) {
                var args = event.args;
                var rowBoundIndex = args.rowindex;
                var dataField = args.datafield;
                if ( dataField === 'TAG_ID' && !args.rightclick) {

                    f_TagRollSetting ( gridTagMstEventId + '.' + dataField, rowBoundIndex );
                }
            });

        } // end of f_initContents

        //*********************************************************************************************
        // ********** Last Process Job
        //*********************************************************************************************
        function f_lastProc() {
            fc_lastProc();
            //fc_setColMaxLength( gridChainTagMstId, 'SCR_ID', 20 );
        } // end of f_lastProc

        //*********************************************************************************************
        // ********** Screen Button Event Section
        //*********************************************************************************************
        function f_search() {
            fc_addParamForm( 'divSearchCondition' );
            fc_searchGrid( [ { gridId: gridTagMstEventId, resultKey: 'RK_TAG_MST_EVENT_LIST' } ], serviceName, "searchTagMstEvent" );
        } // end of f_search

        function f_save() {
            fc_saveGrid( [ gridTagMstEventId ], '', serviceName, 'saveTagMstEvent', '', 'Y' );
        } // end of f_save

        function f_delete() {
            fc_deleteGrid( [ gridTagMstEventId ], '', serviceName, 'deleteTagMstEvent', '', 'Y' );
        } // end of f_delete

        //*********************************************************************************************
        // ********** User Defined Function Section
        //*********************************************************************************************
        function f_TagRollSetting(targetColumn, rowIndex) {
            fc_setGridCheckBoxVal(gridTagMstEventId, rowIndex, true);
            if ( targetColumn == gridTagMstEventId+'.TAG_ID' ) {
                fc_linkagePopup( "SMZ7010", [  { name: "openUrl"	, value:'SMZ7070' 	},
                    { name: "openGridRowIndex"	, value: rowIndex	},
                ], '85%', '90%', true );
            }
        } // end of f_TagRollSetting

        function f_receiveGridData(tag_id, tag_nm, mgmt_ll_val, mgmt_ul_val, rowIndex){
            fc_resizeDivWidth(gridTagMstEventId);
            fc_setCellData( gridTagMstEventId, rowIndex, 'TAG_ID' , tag_id );
            fc_setCellData( gridTagMstEventId, rowIndex, 'TAG_NM' , tag_nm );
            fc_setCellData( gridTagMstEventId, rowIndex, 'LCL_VAL' , mgmt_ll_val );
            fc_setCellData( gridTagMstEventId, rowIndex, 'UCL_VAL' , mgmt_ul_val );
        }
    </script>
</head>
<body>
<div id="divContainer">
    <div id="divTitle">
        <div th:replace="~{BDP/include/includeTitle :: title}"></div>
    </div>
    <div id="divSearchCondition"></div>
    <div id="divContents">
        <div id="divGridTagMstEvent"></div>
    </div>
</div>
<div id="divMessage">
    <div th:replace="~{BDP/include/includeMessage :: message}"></div>
</div>
</body>
</html>